<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Quiz Results</title>
  </head>
  <body>
    <h1>Your Quiz Results</h1>
    <button id="save-pdf">Save PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const savePdfButton = document.getElementById('save-pdf');
        if (savePdfButton) {
          savePdfButton.addEventListener('click', generatePDF);
        } else {
          console.error("Pulsante save-pdf non trovato. Assicurati che esista nel DOM.");
        }
      });

      // Funzione per generare il PDF
      function generatePDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        let yOffset = 10;

        // Recupera i dati del quiz dal localStorage
        const quizResults = JSON.parse(localStorage.getItem('quizResults')) || [];

        quizResults.forEach((questionData, index) => {
          doc.text(`Q${index + 1}: ${questionData.question}`, 10, yOffset);
          yOffset += 10;

          questionData.choices.forEach((choice, i) => {
            const choiceLetter = String.fromCharCode(65 + i); // A, B, C, D...
            const isSelected = questionData.selectedAnswer == (i + 1) ? "(Selected)" : "";
            const isCorrect = questionData.correctAnswer == (i + 1) ? "(Correct)" : "";
            doc.text(`${choiceLetter}. ${choice} ${isSelected} ${isCorrect}`, 10, yOffset);
            yOffset += 10;
          });

          yOffset += 10; // Spazio extra tra le domande
        });

        doc.save('quiz_results.pdf');
      }
    </script>
  </body>
</html>

